# 🎮 方案 A：在 Godot 中测试 - 详细步骤

## 📋 准备工作

### 确认 Godot 已安装
- 需要 **Godot 4.2** 或更高版本
- 如果没有安装，请访问：https://godotengine.org/download/windows/

---

## 🚀 详细步骤

### 步骤 1: 启动 Godot

1. 双击 **Godot** 图标启动
2. 您会看到项目管理器窗口

### 步骤 2: 导入项目

**方法一：如果是首次导入**

1. 在项目管理器中，点击右侧的 **"导入"** 按钮
2. 点击 **"浏览"** 按钮
3. 导航到：`d:\新建文件夹\AGI-Walker\godot_project`
4. 选择 `project.godot` 文件
5. 点击 **"打开"**
6. 点击 **"导入并编辑"**

**方法二：如果已经导入过**

1. 在项目列表中找到 **"AGI-Walker"** 或 **"godot_project"**
2. 双击打开

### 步骤 3: 等待项目加载

- Godot 会加载项目资源
- 可能需要几秒钟
- 加载完成后会看到 Godot 编辑器界面

### 步骤 4: 启用插件（重要！）

1. 点击顶部菜单：**项目 → 项目设置**
2. 在左侧选择 **"插件"** 标签
3. 找到 **"Robot Simulation Toolkit"**
4. 勾选右侧的复选框启用它
5. 点击 **"关闭"** 按钮

**预期反应**：
- 控制台（底部）应该显示：
  ```
  Robot Simulation Toolkit plugin activated
  ```

### 步骤 5: 打开测试场景

1. 在左侧的 **文件系统** 面板中：
   - 展开 `res://` 文件夹
   - 展开 `scenes` 文件夹
   - 找到 `test_environment.tscn`
2. **双击** `test_environment.tscn` 打开场景

**您会看到**：
- 3D 视口中显示一个地面（大方块）
- 一个小方块（测试物体）
- 场景树显示节点结构

### 步骤 6: 运行场景！

**方法一：使用快捷键（推荐）**
- 按键盘 **F5** 键

**方法二：使用菜单**
- 点击顶部菜单：**运行 → 运行场景**

**方法三：使用工具栏**
- 点击右上角的 **"播放场景"** 按钮（▶️ 图标）

### 步骤 7: 观察测试结果

运行后会发生：

1. **新窗口打开** - 显示 3D 场景
2. **控制台输出** - 在 Godot 编辑器底部的"输出"面板

**预期的控制台输出**：
```
=== 环境系统测试 ===

🌍 EnvironmentController initialized
📚 Ground Material Library initialized with 8 materials

[1] 测试环境预设...
✅ Gravity set to: 9.81 m/s²
🌍 Loaded environment preset: 地球
✅ Gravity set to: 1.62 m/s²
🌍 Loaded environment preset: 月球
✅ Gravity set to: 3.71 m/s²
🔴 Loaded environment preset: 火星
  ✅ 环境预设测试完成

[2] 测试地面材质...
  可用材质: [concrete, wood, carpet, ice, metal, sand, grass, mud]
  - Concrete: 摩擦=0.9 弹性=0.1
  - Wood: 摩擦=0.6 弹性=0.2
  - Carpet: 摩擦=1.0 弹性=0.05
  - Ice: 摩擦=0.1 弹性=0.3
  ...
  ✅ 地面材质测试完成

[3] 测试动态参数...
  重力: 9.81 m/s²
  重力: 5.0 m/s²
  重力: 15.0 m/s²
  温度: 25.0 °C
  温度: -50.0 °C
  温度: 100.0 °C
  风力: 5m/s 东风
  ✅ 动态参数测试完成

=== 测试完成 ===
```

**✅ 如果看到这些输出，说明系统正常工作！**

### 步骤 8: 交互测试

在游戏窗口中（运行的3D场景），按键盘测试：

| 按键 | 功能 | 观察效果 |
|------|------|----------|
| **1** | 切换到地球环境 | 控制台显示 "🌍 切换到地球环境"，物体正常下落 |
| **2** | 切换到月球环境 | 控制台显示 "🌑 切换到月球环境"，物体**缓慢**下落（低重力） |
| **3** | 切换到火星环境 | 控制台显示 "🔴 切换到火星环境"，中等重力 |
| **C** | 切换到混凝土地面 | 控制台显示 "切换到混凝土地面"，地面颜色变为灰色 |
| **I** | 切换到冰面 | 控制台显示 "切换到冰面"，地面颜色变为浅蓝色，物体滑行 |
| **S** | 切换到沙地 | 控制台显示 "切换到沙地"，地面颜色变为黄褐色 |

### 步骤 9: 停止运行

- 按 **F8** 键
- 或点击右上角的 **"停止"** 按钮（⏹️）

---

## 🎯 验证成功的标志

如果您看到了以下所有内容，说明测试成功：

- ✅ 场景运行窗口打开
- ✅ 控制台显示完整的测试输出
- ✅ 可以看到地面和测试方块
- ✅ 按键盘快捷键有反应
- ✅ 控制台显示相应的切换信息
- ✅ 重力切换时物体下落速度改变
- ✅ 材质切换时地面颜色改变

---

## 🐛 常见问题

### Q1: 找不到 scenes 文件夹

**解决**:
- 检查文件系统面板左上角，确保选择了 `res://`
- 点击 `res://` 旁边的刷新按钮
- 如果还是没有，场景文件位置：`d:\新建文件夹\AGI-Walker\godot_project\scenes\test_environment.tscn`

### Q2: 运行后没有控制台输出

**解决**:
1. 检查底部面板是否打开（如果没有，点击菜单：视图 → 底部面板）
2. 确保选择了 "输出" 标签而不是 "调试器"
3. 确认插件已启用

### Q3: 按键没有反应

**解决**:
- 确保游戏窗口是**激活**状态（点击一下窗口）
- 尝试用鼠标点击游戏窗口后再按键

### Q4: 场景显示错误

**解决**:
- 可能是脚本路径问题
- 检查 `res://scripts/environment/` 目录是否存在所有脚本
- 检查控制台是否有红色错误信息

### Q5: 插件无法启用

**解决**:
- 检查 `res://addons/robot_sim_toolkit/plugin.cfg` 是否存在
- 重启 Godot

---

## 🎨 进阶实验

测试成功后，您可以尝试：

### 1. 修改测试场景

- 在场景树中选择 `TestCube`
- 修改 `Transform → Position → Y` 值（改变高度）
- 再次运行，观察不同高度的下落

### 2. 添加更多物体

- 右键点击 `TestEnvironment`
- 添加子节点 → `RigidBody3D`
- 给它添加 `CollisionShape3D` 和 `MeshInstance3D`
- 设置不同的位置

### 3. 观察重力差异

- 运行场景
- 按 `1` （地球）- 观察下落速度
- 按 `2` （月球）- 看！物体飘浮的感觉
- 按键让物体重新出现在空中（修改代码或重启）
- 对比效果

### 4. 测试材质差异

- 创建一个球体（`RigidBody3D` + `SphereShape3D`）
- 给它一个水平的初速度
- 切换不同材质（C/I/S）
- 观察滑行距离的变化

---

## 📸 截图参考

### 项目导入界面
```
[Godot 项目管理器]
┌────────────────────────────────┐
│  项目         [新建] [导入]     │
│  ┌──────────────────────────┐  │
│  │ AGI-Walker               │  │
│  │ d:\新建文件夹\...        │  │
│  └──────────────────────────┘  │
│         [编辑] [运行]          │
└────────────────────────────────┘
```

### Godot 编辑器界面
```
┌──────────────────────────────────────────┐
│ 文件 编辑 选择 运行 项目 调试 编辑器 帮助│
├──────────┬───────────────────┬───────────┤
│场景树    │  3D 视口          │ 检查器    │
│          │                   │           │
│TestEnv.. │     [地面]        │ Node3D    │
│├─Env...  │                   │ Transform │
│├─Ground  │    ┌─┐            │ Position  │
│├─TestCube│    └─┘            │ ...       │
│└─Camera  │                   │           │
│          │                   │           │
├──────────┴───────────────────┴───────────┤
│ 文件系统  │  输出(控制台)               │
│ res://    │ === 环境系统测试 ===         │
│ ├─scenes  │ 🌍 EnvironmentController... │
│ ├─scripts │ ...                         │
│ └─addons  │                             │
└───────────┴─────────────────────────────┘
```

---

## ✅ 完成检查清单

- [ ] Godot 已安装并启动
- [ ] 项目成功导入
- [ ] 插件已启用
- [ ] 测试场景已打开
- [ ] 场景成功运行
- [ ] 看到控制台输出
- [ ] 键盘快捷键工作正常
- [ ] 观察到重力和材质变化

---

## 🎊 恭喜！

如果您完成了所有步骤，您已经成功：

- ✅ 在 Godot 中运行了机器人仿真环境
- ✅ 验证了环境控制系统
- ✅ 验证了材质系统
- ✅ 体验了多个行星的重力
- ✅ 完成了实践的核心部分

**下一步可以做什么？**

1. **实验更多参数** - 修改脚本中的数值
2. **创建自己的机器人** - 参考 ADVANCED_USAGE.md
3. **配置 Python 训练** - 连接 TCP 进行 RL 训练
4. **添加新零件** - 扩展零件库

---

**祝您使用愉快！** 🚀

---

**版本**: 1.0  
**最后更新**: 2026-01-14
